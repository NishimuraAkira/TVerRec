# ToDo

## 便利機能

- [x] TVer.jpの検索機能を使ってキーワード指定できるようにする
- [x] 削除対象の番組を部分一致で指定できるようにする
  - [x] 部分一致したものはダウンロードしない
  - [x] ダウンロードされてしまったものでも部分一致で削除する
- [x] プログレスバーの実装
- [ ] メタデータを追加で指定する(タイトルにシリーズ番号、日付、発行者、著作権、トラック番号、エンコーダなど)
- [x] ffmpegのエラーログの古いものを削除
- [x] タレント名で検索してタレントIDを特定し、そこから番組ダウンロード
- [x] 番組名で検索してそこから番組IDを特定し、そこから番組ダウンロード
- [ ] 番組ダウンロード時にジャンルIDの情報を取得し、メタデータとして番組に埋め込む→やり方不明
- [ ] 廃止になったジャンルIDを自動的に削除→タグの一覧取得方法が不明のため対応見込みなし
- [ ] 追加になったジャンルIDを自動的に追加→タグの一覧取得方法が不明のため対応見込みなし
- [x] バージョンアップ通知機能を追加
- [x] ダウンロード先に放送局ごとにディレクトリ分けした上で番組ディレクトリを作るオプションをつける
  - [x] 放送局ごとに保存した番組の最終移動先への移動をサポートする→プルリクで対応
- [x] ダウンロード後のチェック処理もスキップするオプションをつける
- [x] 番組検証に速度重視のモードを追加
- [x] ffmpegの自動更新機能を追加
  - [x] Windows向け
  - [x] mac向け
  - [x] Linux向け
- [x] トースト通知機能を追加
  - [x] Windows向け
  - [x] mac向け
  - [x] Linux向け
- [x] バージョンアップ時にダウンロード履歴ファイルがクリアされないようにする
- [x] バージョンアップ時に設定ファイルがクリアされないようにする
- [x] 検索結果をダウンロードせずに番組リストを出力
- [x] 番組リストを使ったダウンロード
- [x] ダウンロード履歴破損時に破損レコードを削除
- [ ] フリーワードで指定で特定のジャンルからのみダウンロード
- [x] コンテナによる仮想化に対応
- [x] Google Colabでuser_setting.ps1を使用するようにする
- [x] Dockerコンテナでuser_setting.ps1を使用するようにする
- [x] Write-Hostを廃止する
- [ ] 並列処理時にToast通知を更新する
- [x] 並列処理時に並列度を指定できるようにする
- [x] 並列処理を行わないオプションを指定できるようにするかも
- [ ] CRLFではなくLFによるファイル書き込みの強制
  - [x] ダウンロード対象外リスト
  - [x] 設定ファイル
  - [ ] CSVファイル
- [x] リストファイル0件時のエラー処理追加
- [ ] GUIの実装
  - [x] Windows向け
  - [ ] mac向け
  - [ ] Linux向け
- [x] 曜日時間帯別稼働制御の実装

## youtube-dl制御機能

- [x] youtube-dlのパラメータ指定を変更して、メタデータを番組に含めるようにする。その際、中間ファイルが増える可能性があるので削除対象に含めるか検討する
- [x] youtube-dlでダウンロードする際に、中間ファイルの出力先を移動先と分ける
- [x] youtube-dlの番組処理について、パフォーマンスチューニングを検討する

## 性能改善・安定性向上

- [x] ハードウェアアクセラレーションの活用。自動判定は難しいので、設定で変更できるようにした。
- [x] ダウンロード履歴ファイルの排他制御を行い、複数PCから同時実行できるようにする
- [x] 変数のスコープを明確にする
- [x] 変数名を実態に合わせる
- [x] 関数の引数チェックを厳密にする
- [x] 関数の汎用化・正規化を行う
- [x] 番組の情報を引き回すためにカスタムオブジェクトを作成する
- [x] プログレスバーの残骸をきれいにする→どうやら無理っぽいので廃止で対応
- [x] 各種コードチェックに引っかからないように修正
- [x] トークンの取得頻度を下げる

## 対象環境の拡充

- [x] Linuxでの動作確認をする。ひとまずPi4では動いた。Ubuntuでも動く。
- [x] Macでも動作確認をする。ひとまずM1 Mac Miniでは動いた。
